#!/bin/bash

if [[ "$1" == "" ]]; then
	TARGET_CMD="sh -c \"IN_WND_SHELL=1 $SHELL\""
else
	TARGET_CMD="$1"
fi
NSDEPS_FILE="$(git rev-parse --show-toplevel)/.nix_shell_deps"
if [[ -f "$NSDEPS_FILE" ]]; then
	NSDEPS="$(cat $NSDEPS_FILE)"
	eval "nix-shell -p $NSDEPS --command '$TARGET_CMD'"
else
	echo "Could not find <repo>/.nix_shell_deps, exiting."
	exit 1
fi

